<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¹¿å‘Šæ”¶ç›Šæ¸¸æˆ - ç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆ</title>
    
    <!-- ç§»åŠ¨ç«¯ä¼˜åŒ–metaæ ‡ç­¾ -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    
    <style>
        /* åŸºç¡€æ ·å¼ */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; /* ç§»é™¤ç‚¹å‡»é«˜äº® */
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            font-size: 16px;
            -webkit-text-size-adjust: 100%; /* ç¦æ­¢å­—ä½“è‡ªåŠ¨è°ƒæ•´ */
            touch-action: manipulation; /* ä¼˜åŒ–è§¦æ‘¸å“åº” */
        }
        
        body { 
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
            padding: 15px;
            min-height: 100vh;
            color: #fff;
            display: flex;
            flex-direction: column;
        }
        
        /* ç§»åŠ¨ç«¯ä¼˜å…ˆçš„å¸ƒå±€ */
        .mobile-container {
            flex: 1;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
        }
        
        /* ç§»åŠ¨ç«¯çŠ¶æ€æ  */
        .mobile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .mobile-title {
            font-size: 18px;
            font-weight: bold;
            color: #fff;
        }
        
        .mobile-mode {
            background: #FF9800;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* ç§»åŠ¨ç«¯å¹¿å‘Šåˆ—ï¼ˆå‚ç›´æ’åˆ—ï¼‰ */
        .mobile-columns {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
            flex: 1;
        }
        
        .mobile-ad-slot {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            flex-direction: column;
            min-height: 140px;
        }
        
        .slot-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .slot-number {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }
        
        .slot-title {
            font-size: 16px;
            font-weight: bold;
            color: #fff;
        }
        
        .slot-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .slot-status {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 10px;
            margin: 8px 0;
            font-size: 13px;
            text-align: center;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .slot-earnings {
            font-size: 13px;
            color: #ccc;
            text-align: center;
            margin: 5px 0;
        }
        
        .earnings-amount {
            color: #4CAF50;
            font-weight: bold;
            font-size: 16px;
        }
        
        /* ç§»åŠ¨ç«¯ä¼˜åŒ–æŒ‰é’® */
        .mobile-ad-btn {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            padding: 15px 0;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            min-height: 50px; /* æ˜“äºç‚¹å‡» */
            touch-action: manipulation;
            transition: all 0.2s;
        }
        
        .mobile-ad-btn:active {
            transform: scale(0.98);
            opacity: 0.9;
        }
        
        .mobile-ad-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        /* ç§»åŠ¨ç«¯æ§åˆ¶é¢æ¿ */
        .mobile-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 15px 0;
        }
        
        .mobile-control-btn {
            background: rgba(33, 150, 243, 0.8);
            color: white;
            border: none;
            padding: 12px 5px;
            border-radius: 10px;
            font-size: 12px;
            cursor: pointer;
            min-height: 40px;
            touch-action: manipulation;
        }
        
        /* ç§»åŠ¨ç«¯ç»Ÿè®¡å¡ç‰‡ */
        .mobile-stats {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin-top: 10px;
            margin-bottom: 15px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .stat-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            border-left: 4px solid #4CAF50;
        }
        
        .stat-label {
            font-size: 11px;
            color: #aaa;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #fff;
        }
        
        /* ç§»åŠ¨ç«¯è¡¨æ ¼ï¼ˆç®€åŒ–ç‰ˆï¼‰ */
        .mobile-records {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 10px;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .record-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 12px;
        }
        
        /* æ¨ªå±ä¼˜åŒ– */
        @media (orientation: landscape) {
            .mobile-columns {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .mobile-ad-slot {
                width: 48%;
                min-height: 180px;
            }
        }
        
        /* å¹³æ¿ä¼˜åŒ– */
        @media (min-width: 768px) {
            .mobile-container {
                max-width: 800px;
            }
            
            .mobile-columns {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: space-between;
            }
            
            .mobile-ad-slot {
                width: 32%;
                min-height: 200px;
            }
            
            .mobile-controls {
                grid-template-columns: repeat(6, 1fr);
            }
        }
        
        /* åŠ¨ç”» */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease;
        }
        
        /* é˜²æ­¢IOSæ©¡çš®ç­‹æ•ˆæœ */
        .no-bounce {
            overflow: hidden;
            position: fixed;
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body class="no-bounce">
    <div class="mobile-container fade-in">
        <!-- ç§»åŠ¨ç«¯å¤´éƒ¨ -->
        <div class="mobile-header">
            <div class="mobile-title">ğŸ’° å¹¿å‘Šæ”¶ç›Šæ¸¸æˆ</div>
            <div class="mobile-mode" id="mode-badge">ğŸ¬ æ¨¡æ‹Ÿæ¨¡å¼</div>
        </div>
        
        <!-- æ§åˆ¶æŒ‰é’® -->
        <div class="mobile-controls">
            <button class="mobile-control-btn" onclick="showAllAds()">ğŸš€ ä¸€é”®æµ‹è¯•</button>
            <button class="mobile-control-btn" onclick="resetGame()">ğŸ”„ é‡ç½®</button>
            <button class="mobile-control-btn" onclick="tryRealMode()">ğŸ’° çœŸå®æ¨¡å¼</button>
            <button class="mobile-control-btn" onclick="exportData()">ğŸ’¾ å¯¼å‡º</button>
            <button class="mobile-control-btn" onclick="showHelp()">â“ å¸®åŠ©</button>
            <button class="mobile-control-btn" onclick="toggleTheme()">ğŸ¨ ä¸»é¢˜</button>
        </div>
        
        <!-- å¹¿å‘Šä½ï¼ˆç§»åŠ¨ç«¯å‚ç›´æ’åˆ—ï¼‰ -->
        <div class="mobile-columns">
            <!-- å¹¿å‘Šä½1 -->
            <div class="mobile-ad-slot">
                <div class="slot-header">
                    <div class="slot-number">1</div>
                    <div class="slot-title">å¹¿å‘Šä½ 1</div>
                </div>
                <div class="slot-content">
                    <div class="slot-status" id="status1">âœ… å‡†å¤‡å°±ç»ª</div>
                    <div class="slot-earnings">
                        æ”¶ç›Š: <span class="earnings-amount" id="earnings1">$0.00</span>
                    </div>
                    <button class="mobile-ad-btn" onclick="showAd(1)" id="btn1">
                        ğŸ¬ è§‚çœ‹å¹¿å‘Š
                    </button>
                </div>
            </div>
            
            <!-- å¹¿å‘Šä½2 -->
            <div class="mobile-ad-slot">
                <div class="slot-header">
                    <div class="slot-number">2</div>
                    <div class="slot-title">å¹¿å‘Šä½ 2</div>
                </div>
                <div class="slot-content">
                    <div class="slot-status" id="status2">âœ… å‡†å¤‡å°±ç»ª</div>
                    <div class="slot-earnings">
                        æ”¶ç›Š: <span class="earnings-amount" id="earnings2">$0.00</span>
                    </div>
                    <button class="mobile-ad-btn" onclick="showAd(2)" id="btn2">
                        ğŸ¬ è§‚çœ‹å¹¿å‘Š
                    </button>
                </div>
            </div>
            
            <!-- å¹¿å‘Šä½3 -->
            <div class="mobile-ad-slot">
                <div class="slot-header">
                    <div class="slot-number">3</div>
                    <div class="slot-title">å¹¿å‘Šä½ 3</div>
                </div>
                <div class="slot-content">
                    <div class="slot-status" id="status3">âœ… å‡†å¤‡å°±ç»ª</div>
                    <div class="slot-earnings">
                        æ”¶ç›Š: <span class="earnings-amount" id="earnings3">$0.00</span>
                    </div>
                    <button class="mobile-ad-btn" onclick="showAd(3)" id="btn3">
                        ğŸ¬ è§‚çœ‹å¹¿å‘Š
                    </button>
                </div>
            </div>
        </div>
        
        <!-- ç§»åŠ¨ç«¯ç»Ÿè®¡ -->
        <div class="mobile-stats">
            <div style="text-align:center;font-size:16px;font-weight:bold;margin-bottom:15px;">
                ğŸ“Š æ”¶ç›Šç»Ÿè®¡
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">ä»Šæ—¥æ”¶ç›Š</div>
                    <div class="stat-value" id="todayEarnings">$0.00</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ç´¯è®¡æ”¶ç›Š</div>
                    <div class="stat-value" id="totalEarnings">$0.00</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">å¹¿å‘Šå±•ç¤º</div>
                    <div class="stat-value" id="impressions">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ç‚¹å‡»ç‡</div>
                    <div class="stat-value" id="clickRate">0%</div>
                </div>
            </div>
            
            <!-- æ”¶ç›Šè®°å½• -->
            <div style="margin-top:15px;">
                <div style="font-size:14px;font-weight:bold;margin-bottom:10px;display:flex;justify-content:space-between;">
                    <span>ğŸ“… ä»Šæ—¥è®°å½•</span>
                    <span style="font-size:12px;color:#aaa;" id="recordCount">0æ¡</span>
                </div>
                <div class="mobile-records" id="dailyRecords">
                    <div style="text-align:center;padding:20px;color:#aaa;">
                        æš‚æ— æ”¶ç›Šè®°å½•
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== ç§»åŠ¨ç«¯ä¼˜åŒ– ==========
        // æ£€æµ‹è®¾å¤‡ç±»å‹
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
        const isAndroid = /Android/i.test(navigator.userAgent);
        
        // ç§»åŠ¨ç«¯ä¼˜åŒ–è®¾ç½®
        if (isMobile) {
            console.log('ğŸ“± ç§»åŠ¨è®¾å¤‡æ£€æµ‹: ', isIOS ? 'iOS' : isAndroid ? 'Android' : 'Mobile');
            
            // æ·»åŠ ç§»åŠ¨ç«¯ç‰¹å®šæ ·å¼
            document.documentElement.style.setProperty('--touch-optimized', 'true');
            
            // é˜²æ­¢åŒå‡»ç¼©æ”¾
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(event) {
                const now = Date.now();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
        }
        
        // ========== æ¸¸æˆé…ç½® ==========
        const CONFIG = {
            mode: 'simulation', // simulation | real
            adCooldown: 30,
            baseEarnings: 0.35,
            gameId: '6028834',
            adUnits: ['youmeng1', 'youmeng2', 'youmeng3']
        };
        
        // ========== æ¸¸æˆæ•°æ® ==========
        let gameData = {
            impressions: 0,
            clicks: 0,
            todayEarnings: 0,
            totalEarnings: 0,
            adCooldowns: [0, 0, 0],
            adEarnings: [0, 0, 0],
            dailyRecords: [],
            todayDate: new Date().toLocaleDateString('zh-CN')
        };
        
        // ========== ç§»åŠ¨ç«¯å¹¿å‘Šç³»ç»Ÿ ==========
        class MobileAdSystem {
            constructor() {
                console.log('ğŸ“± ç§»åŠ¨ç«¯å¹¿å‘Šç³»ç»Ÿå¯åŠ¨');
                this.init();
            }
            
            init() {
                // æ›´æ–°æ¨¡å¼æ˜¾ç¤º
                this.updateModeDisplay();
                
                // ç§»åŠ¨ç«¯ç‰¹å®šä¼˜åŒ–
                if (isMobile) {
                    this.optimizeForMobile();
                }
            }
            
            optimizeForMobile() {
                console.log('âš¡ è¿›è¡Œç§»åŠ¨ç«¯ä¼˜åŒ–...');
                
                // å¢å¤§è§¦æ‘¸ç›®æ ‡
                document.querySelectorAll('button').forEach(btn => {
                    btn.style.minHeight = '44px';
                });
                
                // ä¼˜åŒ–æ»šåŠ¨
                document.body.style.overflow = 'hidden';
                document.documentElement.style.overflow = 'hidden';
                
                // æ·»åŠ ç§»åŠ¨ç«¯æç¤º
                if (!localStorage.getItem('mobileTipShown')) {
                    setTimeout(() => {
                        this.showMobileTip();
                        localStorage.setItem('mobileTipShown', 'true');
                    }, 1500);
                }
            }
            
            showMobileTip() {
                const tip = document.createElement('div');
                tip.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.9);
                    z-index: 10000;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                    align-items: center;
                    padding: 20px;
                    text-align: center;
                `;
                
                tip.innerHTML = `
                    <div style="background: linear-gradient(135deg, #1a1a2e, #16213e); padding: 25px; border-radius: 20px; max-width: 400px; width: 90%;">
                        <h2 style="color: #4CAF50; margin-bottom: 20px;">ğŸ“± ç§»åŠ¨ç«¯ä½¿ç”¨æç¤º</h2>
                        
                        <div style="text-align: left; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                <div style="background: #4CAF50; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-weight: bold;">
                                    1
                                </div>
                                <span>æŒ‰é’®å·²ä¼˜åŒ–ï¼Œä¾¿äºç‚¹å‡»</span>
                            </div>
                            
                            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                <div style="background: #4CAF50; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-weight: bold;">
                                    2
                                </div>
                                <span>å»ºè®®æ¨ªå±è·å¾—æ›´å¥½ä½“éªŒ</span>
                            </div>
                            
                            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                <div style="background: #4CAF50; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-weight: bold;">
                                    3
                                </div>
                                <span>ç‚¹å‡»å¹¿å‘ŠæŒ‰é’®å¼€å§‹èµšé’±</span>
                            </div>
                        </div>
                        
                        <button onclick="this.parentElement.parentElement.remove()" style="background: #4CAF50; color: white; border: none; padding: 15px 30px; border-radius: 25px; font-size: 16px; font-weight: bold; width: 100%;">
                            å¼€å§‹æ¸¸æˆ
                        </button>
                    </div>
                `;
                
                document.body.appendChild(tip);
            }
            
            updateModeDisplay() {
                const badge = document.getElementById('mode-badge');
                if (badge) {
                    if (CONFIG.mode === 'real') {
                        badge.textContent = 'ğŸ’° çœŸå®æ”¶ç›Š';
                        badge.style.background = '#4CAF50';
                    } else {
                        badge.textContent = 'ğŸ¬ æ¨¡æ‹Ÿæ¨¡å¼';
                        badge.style.background = '#FF9800';
                    }
                }
            }
            
            async showAd(adSlotId) {
                if (CONFIG.mode === 'real') {
                    return this.showRealAd(adSlotId);
                } else {
                    return this.showSimulationAd(adSlotId);
                }
            }
            
            async showRealAd(adSlotId) {
                console.log(`ğŸ¬ ç§»åŠ¨ç«¯çœŸå®å¹¿å‘Š ${adSlotId}`);
                
                if (typeof unityads === 'undefined') {
                    // å°è¯•åŠ è½½Unity SDK
                    return new Promise((resolve) => {
                        this.loadUnitySDK().then(success => {
                            if (success) {
                                this.showRealAd(adSlotId).then(resolve);
                            } else {
                                // åŠ è½½å¤±è´¥ï¼Œåˆ‡æ¢åˆ°æ¨¡æ‹Ÿ
                                this.showSimulationAd(adSlotId).then(resolve);
                            }
                        });
                    });
                }
                
                // çœŸå®å¹¿å‘Šé€»è¾‘
                const adUnitId = CONFIG.adUnits[adSlotId - 1];
                
                return new Promise((resolve) => {
                    unityads.show(adUnitId, {
                        onClosed: (result) => {
                            if (result && result.completed) {
                                this.recordAdComplete(adSlotId, true);
                                resolve({ success: true, isRealAd: true });
                            } else {
                                resolve({ success: false, message: 'å¹¿å‘Šæœªå®Œæˆ' });
                            }
                        },
                        onFailed: (error) => {
                            console.error('ç§»åŠ¨ç«¯çœŸå®å¹¿å‘Šå¤±è´¥:', error);
                            this.showSimulationAd(adSlotId).then(resolve);
                        }
                    });
                });
            }
            
            async loadUnitySDK() {
                return new Promise((resolve) => {
                    const script = document.createElement('script');
                    script.src = 'https://cdn.unityads.unity3d.com/unity-ads-sdk.js';
                    script.crossOrigin = 'anonymous';
                    
                    script.onload = () => {
                        if (typeof unityads !== 'undefined') {
                            // åˆå§‹åŒ–Unity
                            unityads.init(CONFIG.gameId, {
                                testMode: false,
                                onInitialized: () => {
                                    console.log('âœ… ç§»åŠ¨ç«¯Unityåˆå§‹åŒ–æˆåŠŸ');
                                    CONFIG.mode = 'real';
                                    this.updateModeDisplay();
                                    resolve(true);
                                },
                                onFailed: (error) => {
                                    console.error('âŒ ç§»åŠ¨ç«¯Unityåˆå§‹åŒ–å¤±è´¥:', error);
                                    resolve(false);
                                }
                            });
                        } else {
                            resolve(false);
                        }
                    };
                    
                    script.onerror = () => {
                        console.log('âŒ ç§»åŠ¨ç«¯Unity SDKåŠ è½½å¤±è´¥');
                        resolve(false);
                    };
                    
                    document.head.appendChild(script);
                });
            }
            
            showSimulationAd(adSlotId) {
                return new Promise((resolve) => {
                    this.showMobileAdInterface(adSlotId, resolve);
                });
            }
            
            showMobileAdInterface(adSlotId, resolve) {
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.95);
                    z-index: 9999;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                    align-items: center;
                    padding: 20px;
                `;
                
                const earnings = CONFIG.baseEarnings * (0.8 + Math.random() * 0.4);
                
                overlay.innerHTML = `
                    <div style="background: linear-gradient(135deg, #1a1a2e, #16213e); color: white; border-radius: 20px; padding: 25px; width: 100%; max-width: 400px; text-align: center;">
                        <div style="font-size: 50px; margin-bottom: 15px;">ğŸ“±</div>
                        <h3 style="margin-bottom: 10px; color: #4CAF50;">å¹¿å‘Šæ¼”ç¤º</h3>
                        <p style="opacity: 0.8; margin-bottom: 20px;">å¹¿å‘Šä½ ${adSlotId} | 30ç§’æ¼”ç¤º</p>
                        
                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px; margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                <div>
                                    <div style="font-size: 12px; opacity: 0.7;">é¢„ä¼°æ”¶ç›Š</div>
                                    <div style="color: #4CAF50; font-size: 24px; font-weight: bold;">$${earnings.toFixed(2)}</div>
                                </div>
                                <div>
                                    <div style="font-size: 12px; opacity: 0.7;">å‰©ä½™æ—¶é—´</div>
                                    <div style="font-size: 24px; font-weight: bold;" id="ad-timer">30</div>
                                </div>
                            </div>
                            
                            <div style="width: 100%; background: rgba(255,255,255,0.1); height: 8px; border-radius: 4px;">
                                <div id="ad-progress" style="width: 0%; height: 100%; background: #4CAF50; border-radius: 4px; transition: width 1s linear;"></div>
                            </div>
                        </div>
                        
                        <button id="complete-btn" style="background: #4CAF50; color: white; border: none; padding: 18px; border-radius: 25px; font-size: 18px; font-weight: bold; width: 100%; margin-top: 10px;">
                            å®Œæˆè§‚çœ‹ (+$${earnings.toFixed(2)})
                        </button>
                        
                        ${CONFIG.mode === 'simulation' ? `
                        <div style="margin-top: 20px; font-size: 12px; opacity: 0.6; padding: 10px; background: rgba(255,152,0,0.1); border-radius: 10px;">
                            ğŸ’¡ æç¤ºï¼šä½¿ç”¨VPNå¯åˆ‡æ¢åˆ°çœŸå®æ”¶ç›Šæ¨¡å¼
                        </div>
                        ` : ''}
                    </div>
                `;
                
                document.body.appendChild(overlay);
                
                let timeLeft = 30;
                const timerEl = document.getElementById('ad-timer');
                const progressEl = document.getElementById('ad-progress');
                let timerInterval;
                
                function updateTimer() {
                    timeLeft--;
                    timerEl.textContent = timeLeft;
                    const progress = ((30 - timeLeft) / 30) * 100;
                    progressEl.style.width = `${progress}%`;
                    
                    if (timeLeft <= 0) {
                        completeAd();
                    }
                }
                
                timerInterval = setInterval(updateTimer, 1000);
                
                function completeAd() {
                    clearInterval(timerInterval);
                    document.body.removeChild(overlay);
                    
                    adSystem.recordAdComplete(adSlotId, false, earnings);
                    resolve({ success: true, isRealAd: false });
                }
                
                // è§¦æ‘¸äº‹ä»¶ä¼˜åŒ–
                const completeBtn = document.getElementById('complete-btn');
                completeBtn.addEventListener('click', completeAd);
                completeBtn.addEventListener('touchend', function(e) {
                    e.preventDefault();
                    completeAd();
                });
            }
            
            recordAdComplete(adSlotId, isRealAd, earnings) {
                const adId = adSlotId - 1;
                
                gameData.impressions++;
                gameData.clicks++;
                gameData.todayEarnings += earnings;
                gameData.totalEarnings += earnings;
                gameData.adEarnings[adId] += earnings;
                gameData.adCooldowns[adId] = CONFIG.adCooldown;
                
                this.addDailyRecord(adSlotId, earnings, isRealAd ? 'çœŸå®' : 'æ¨¡æ‹Ÿ');
                
                updateStats();
                updateCooldownDisplay();
                updateDailyRecords();
                
                this.updateAdStatus(adSlotId, isRealAd);
            }
            
            addDailyRecord(adSlotId, earnings, type) {
                const now = new Date();
                const timeStr = now.toLocaleTimeString('zh-CN', {
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: false
                });
                
                const record = {
                    time: timeStr,
                    adSlot: adSlotId,
                    earnings: earnings.toFixed(2),
                    type: type
                };
                
                // æ·»åŠ åˆ°ä»Šæ—¥è®°å½•
                if (!gameData.dailyRecords[gameData.todayDate]) {
                    gameData.dailyRecords[gameData.todayDate] = [];
                }
                
                gameData.dailyRecords[gameData.todayDate].unshift(record);
                
                // é™åˆ¶è®°å½•æ•°é‡
                if (gameData.dailyRecords[gameData.todayDate].length > 20) {
                    gameData.dailyRecords[gameData.todayDate] = gameData.dailyRecords[gameData.todayDate].slice(0, 20);
                }
            }
            
            updateAdStatus(adSlotId, isRealAd) {
                const statusEl = document.getElementById(`status${adSlotId}`);
                const earningsEl = document.getElementById(`earnings${adSlotId}`);
                
                if (statusEl) {
                    statusEl.textContent = isRealAd ? 'âœ… çœŸå®å®Œæˆ' : 'âœ… æ¨¡æ‹Ÿå®Œæˆ';
                }
                
                if (earningsEl) {
                    earningsEl.textContent = '$' + gameData.adEarnings[adSlotId - 1].toFixed(2);
                    
                    // ç§»åŠ¨ç«¯åŠ¨ç”»
                    earningsEl.style.transition = 'transform 0.3s';
                    earningsEl.style.transform = 'scale(1.2)';
                    setTimeout(() => {
                        earningsEl.style.transform = 'scale(1)';
                    }, 300);
                }
            }
        }
        
        // ========== åˆå§‹åŒ– ==========
        const adSystem = new MobileAdSystem();
        
        // å†·å´è®¡æ—¶å™¨
        setInterval(() => {
            gameData.adCooldowns = gameData.adCooldowns.map(cd => 
                cd > 0 ? cd - 1 : 0
            );
            updateCooldownDisplay();
        }, 1000);
        
        // æ˜¾ç¤ºå¹¿å‘Š
        async function showAd(adIndex) {
            const adId = adIndex - 1;
            
            if (gameData.adCooldowns[adId] > 0) {
                alert(`å†·å´ä¸­ï¼Œè¯·ç­‰å¾… ${gameData.adCooldowns[adId]} ç§’`);
                return;
            }
            
            const btn = document.getElementById(`btn${adIndex}`);
            const statusEl = document.getElementById(`status${adIndex}`);
            
            // ç§»åŠ¨ç«¯ä¼˜åŒ–ï¼šç¦ç”¨æŒ‰é’®é˜²æ­¢å¤šæ¬¡ç‚¹å‡»
            btn.disabled = true;
            btn.innerHTML = 'â³ åŠ è½½ä¸­...';
            statusEl.innerHTML = 'â³ å‡†å¤‡å¹¿å‘Š...';
            
            // ç§»åŠ¨ç«¯è§¦æ‘¸åé¦ˆ
            if (isMobile) {
                btn.style.opacity = '0.8';
            }
            
            try {
                const result = await adSystem.showAd(adIndex);
                
                if (result.success) {
                    if (result.isRealAd) {
                        statusEl.innerHTML = 'âœ… çœŸå®å®Œæˆ';
                    } else {
                        statusEl.innerHTML = 'âœ… æ¨¡æ‹Ÿå®Œæˆ';
                    }
                } else {
                    statusEl.innerHTML = `âš ï¸ ${result.message}`;
                }
            } catch (error) {
                console.error('å¹¿å‘Šé”™è¯¯:', error);
                statusEl.innerHTML = 'âŒ å¹¿å‘Šå¤±è´¥';
            }
            
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            setTimeout(() => {
                btn.disabled = false;
                btn.innerHTML = 'ğŸ¬ è§‚çœ‹å¹¿å‘Š';
                if (isMobile) {
                    btn.style.opacity = '1';
                }
            }, 1000);
        }
        
        // æ›´æ–°å†·å´æ˜¾ç¤º
        function updateCooldownDisplay() {
            for (let i = 0; i < 3; i++) {
                const statusEl = document.getElementById(`status${i + 1}`);
                const btn = document.getElementById(`btn${i + 1}`);
                
                const cd = gameData.adCooldowns[i];
                if (cd > 0) {
                    statusEl.innerHTML = `â³ ${cd}ç§’`;
                    btn.disabled = true;
                    btn.innerHTML = `å†·å´ä¸­`;
                } else {
                    statusEl.innerHTML = 'âœ… å‡†å¤‡å°±ç»ª';
                    btn.disabled = false;
                    btn.innerHTML = 'ğŸ¬ è§‚çœ‹å¹¿å‘Š';
                }
            }
        }
        
        // æ›´æ–°ç»Ÿè®¡
        function updateStats() {
            document.getElementById('impressions').textContent = gameData.impressions;
            document.getElementById('todayEarnings').textContent = '$' + gameData.todayEarnings.toFixed(2);
            document.getElementById('totalEarnings').textContent = '$' + gameData.totalEarnings.toFixed(2);
            
            const clickRate = gameData.impressions > 0 ? 
                ((gameData.clicks / gameData.impressions) * 100).toFixed(1) : 0;
            document.getElementById('clickRate').textContent = clickRate + '%';
            
            for (let i = 0; i < 3; i++) {
                const el = document.getElementById(`earnings${i + 1}`);
                if (el) el.textContent = '$' + gameData.adEarnings[i].toFixed(2);
            }
            
            saveGameData();
        }
        
        // æ›´æ–°æ—¥æ”¶ç›Šè®°å½•
        function updateDailyRecords() {
            const container = document.getElementById('dailyRecords');
            if (!container) return;
            
            const todayRecords = gameData.dailyRecords[gameData.todayDate] || [];
            
            // æ›´æ–°è®°å½•æ•°é‡
            document.getElementById('recordCount').textContent = `${todayRecords.length}æ¡`;
            
            if (todayRecords.length === 0) {
                container.innerHTML = `
                    <div style="text-align:center;padding:20px;color:#aaa;">
                        æš‚æ— æ”¶ç›Šè®°å½•
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            
            todayRecords.forEach(record => {
                const item = document.createElement('div');
                item.className = 'record-item';
                item.innerHTML = `
                    <span>${record.time}</span>
                    <span>å¹¿å‘Šä½ ${record.adSlot}</span>
                    <span style="color: ${record.type === 'çœŸå®' ? '#4CAF50' : '#FF9800'}; font-weight: bold;">
                        $${record.earnings}
                    </span>
                `;
                container.appendChild(item);
            });
        }
        
        // ä¿å­˜æ•°æ®
        function saveGameData() {
            try {
                localStorage.setItem('mobileAdGameData', JSON.stringify(gameData));
            } catch (error) {
                console.log('ä¿å­˜å¤±è´¥:', error);
            }
        }
        
        // åŠ è½½æ•°æ®
        function loadGameData() {
            try {
                const saved = localStorage.getItem('mobileAdGameData');
                if (saved) {
                    const parsed = JSON.parse(saved);
                    const today = new Date().toLocaleDateString('zh-CN');
                    
                    if (parsed.todayDate !== today) {
                        parsed.todayEarnings = 0;
                        parsed.todayDate = today;
                        parsed.adCooldowns = [0, 0, 0];
                    }
                    
                    gameData = {
                        ...gameData,
                        ...parsed,
                        adCooldowns: parsed.adCooldowns || [0, 0, 0],
                        adEarnings: parsed.adEarnings || [0, 0, 0],
                        dailyRecords: parsed.dailyRecords || {}
                    };
                    
                    updateStats();
                    updateDailyRecords();
                    updateCooldownDisplay();
                }
            } catch (error) {
                console.log('åŠ è½½å¤±è´¥:', error);
            }
        }
        
        // ========== ç§»åŠ¨ç«¯æ§åˆ¶åŠŸèƒ½ ==========
        window.showAllAds = function() {
            for (let i = 1; i <= 3; i++) {
                if (gameData.adCooldowns[i - 1] === 0) {
                    setTimeout(() => {
                        const btn = document.getElementById(`btn${i}`);
                        if (btn && !btn.disabled) {
                            showAd(i);
                        }
                    }, i * 800);
                }
            }
        };
        
        window.resetGame = function() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ¸¸æˆæ•°æ®å—ï¼Ÿ')) {
                gameData = {
                    impressions: 0,
                    clicks: 0,
                    todayEarnings: 0,
                    totalEarnings: 0,
                    adCooldowns: [0, 0, 0],
                    adEarnings: [0, 0, 0],
                    dailyRecords: {},
                    todayDate: new Date().toLocaleDateString('zh-CN')
                };
                
                updateStats();
                updateDailyRecords();
                updateCooldownDisplay();
                
                alert('âœ… æ¸¸æˆæ•°æ®å·²é‡ç½®ï¼');
            }
        };
        
        window.tryRealMode = function() {
            if (CONFIG.mode === 'real') {
                alert('ğŸ’° å·²ç»æ˜¯çœŸå®æ”¶ç›Šæ¨¡å¼');
                return;
            }
            
            if (confirm('åˆ‡æ¢åˆ°çœŸå®æ”¶ç›Šæ¨¡å¼ï¼Ÿ\n\néœ€è¦ï¼š\nâœ… æµ·å¤–ç½‘ç»œæˆ–VPNè¿æ¥\nâœ… å…è®¸åŠ è½½Unity SDK\n\nç¡®å®šè¦åˆ‡æ¢å—ï¼Ÿ')) {
                adSystem.loadUnitySDK().then(success => {
                    if (success) {
                        alert('ğŸ‰ å·²åˆ‡æ¢åˆ°çœŸå®æ”¶ç›Šæ¨¡å¼ï¼\nğŸ’° ç°åœ¨å¼€å§‹äº§ç”ŸçœŸå®ç¾å…ƒæ”¶ç›Šï¼');
                    } else {
                        alert('âŒ åˆ‡æ¢å¤±è´¥\nè¯·æ£€æŸ¥ç½‘ç»œæˆ–ä½¿ç”¨VPNè¿æ¥åé‡è¯•');
                    }
                });
            }
        };
        
        window.exportData = function() {
            const dataStr = JSON.stringify(gameData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            const fileName = `å¹¿å‘Šæ”¶ç›Šæ•°æ®_${new Date().toISOString().split('T')[0]}.json`;
            
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', fileName);
            link.click();
            
            alert('âœ… æ•°æ®å·²å¯¼å‡ºä¸ºJSONæ–‡ä»¶');
        };
        
        window.showHelp = function() {
            const helpText = `
ğŸ“± ç§»åŠ¨ç«¯ä½¿ç”¨æŒ‡å—ï¼š

ğŸ® åŸºæœ¬æ“ä½œï¼š
1. ç‚¹å‡»"è§‚çœ‹å¹¿å‘Š"æŒ‰é’®å¼€å§‹
2. ç­‰å¾…30ç§’å¹¿å‘Šæ¼”ç¤ºå®Œæˆ
3. è·å¾—æ¨¡æ‹Ÿæ”¶ç›Š

ğŸ’° æ”¶ç›Šæ¨¡å¼ï¼š
- æ¨¡æ‹Ÿæ¨¡å¼ï¼šæ‰€æœ‰ç”¨æˆ·å¯ç”¨
- çœŸå®æ¨¡å¼ï¼šéœ€è¦VPNè¿æ¥

âš¡ ä¼˜åŒ–æç¤ºï¼š
- æŒ‰é’®å·²æ”¾å¤§ä¾¿äºç‚¹å‡»
- å»ºè®®æ¨ªå±è·å¾—æ›´å¥½ä½“éªŒ
- å†·å´æ—¶é—´30ç§’

ğŸŒ ç½‘ç»œè¯´æ˜ï¼š
- ä¸­å›½å¤§é™†è®¿é—®Unityå—é™
- æµ·å¤–/VPNç”¨æˆ·å¯åˆ‡æ¢çœŸå®æ¨¡å¼

ğŸ’¡ å»ºè®®ï¼š
å…ˆç”¨æ¨¡æ‹Ÿæ¨¡å¼ç†Ÿæ‚‰æ¸¸æˆ
æœ‰æ¡ä»¶å†åˆ‡æ¢åˆ°çœŸå®æ¨¡å¼
            `;
            
            alert(helpText);
        };
        
        window.toggleTheme = function() {
            const isDark = document.body.style.background.includes('#1a1a2e');
            
            if (isDark) {
                // åˆ‡æ¢åˆ°æµ…è‰²ä¸»é¢˜
                document.body.style.background = 'linear-gradient(135deg, #f5f7fa, #c3cfe2)';
                document.body.style.color = '#333';
            } else {
                // åˆ‡æ¢å›æ·±è‰²ä¸»é¢˜
                document.body.style.background = 'linear-gradient(135deg, #1a1a2e, #16213e)';
                document.body.style.color = '#fff';
            }
        };
        
        // ========== é¡µé¢åŠ è½½ ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆæ¸¸æˆåŠ è½½å®Œæˆ');
            console.log('è®¾å¤‡ç±»å‹:', isMobile ? (isIOS ? 'iOS' : 'Android') : 'æ¡Œé¢ç«¯');
            
            // åŠ è½½æ•°æ®
            loadGameData();
            
            // è‡ªåŠ¨ä¿å­˜
            setInterval(saveGameData, 30000);
            
            // ç§»åŠ¨ç«¯é¢å¤–ä¼˜åŒ–
            if (isMobile) {
                // é˜²æ­¢æ»šåŠ¨
                document.addEventListener('touchmove', function(e) {
                    if (e.target.tagName === 'BUTTON') {
                        e.preventDefault();
                    }
                }, { passive: false });
                
                // æ¨ªå±æ£€æµ‹
                window.addEventListener('orientationchange', function() {
                    setTimeout(() => {
                        alert('ğŸ”„ æ£€æµ‹åˆ°å±å¹•æ–¹å‘å˜åŒ–ï¼Œå·²ä¼˜åŒ–å¸ƒå±€');
                    }, 500);
                });
            }
            
            console.log('âœ… æ¸¸æˆå°±ç»ªï¼Œæ¬¢è¿ä½“éªŒï¼');
        });
        
        // è‡ªåŠ¨ä¿å­˜
        window.addEventListener('beforeunload', saveGameData);
    </script>
</body>
</html>
