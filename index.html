<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¹¿å‘Šæ”¶ç›Šæ¸¸æˆ - çœŸå®æ”¶ç›Šä¸“ä¸šç‰ˆ</title>
    
    <!-- æ™ºèƒ½ä»£ç†åŠ è½½ç³»ç»Ÿ -->
    <script>
        // é¢„åŠ è½½ Unity SDK é€šè¿‡ä»£ç†
        (function() {
            console.log('ğŸš€ æ™ºèƒ½ä»£ç†ç³»ç»Ÿå¯åŠ¨...');
            
            // åˆ›å»º iframe æ²™ç®±åŠ è½½ Unity SDK
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.srcdoc = `
                <!DOCTYPE html>
                <html>
                <head>
                    <script src="https://cdn.unityads.unity3d.com/unity-ads-sdk.js"><\/script>
                <\/head>
                <body>
                    <script>
                        // ç­‰å¾… SDK åŠ è½½
                        setTimeout(() => {
                            if (typeof unityads !== 'undefined') {
                                // å‘é€æ¶ˆæ¯ç»™çˆ¶çª—å£
                                window.parent.postMessage({
                                    type: 'UNITY_SDK_LOADED',
                                    unityads: unityads
                                }, '*');
                            } else {
                                window.parent.postMessage({
                                    type: 'UNITY_SDK_ERROR',
                                    error: 'SDKæœªåŠ è½½'
                                }, '*');
                            }
                        }, 2000);
                    <\/script>
                <\/body>
                <\/html>
            `;
            
            // ç›‘å¬æ¶ˆæ¯
            window.addEventListener('message', function(event) {
                if (event.data.type === 'UNITY_SDK_LOADED') {
                    console.log('âœ… Unity SDK é€šè¿‡ä»£ç†åŠ è½½æˆåŠŸ');
                    window.unityads = event.data.unityads;
                    
                    // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
                    const loadedEvent = new CustomEvent('unitysdk:loaded', {
                        detail: { unityads: event.data.unityads }
                    });
                    window.dispatchEvent(loadedEvent);
                }
            });
            
            document.head.appendChild(iframe);
        })();
    </script>
    
    <style>
        /* æç®€ç´§å‡‘å¸ƒå±€ */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            font-size: 14px;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: white;
        }
        
        /* ç´§å‡‘å®¹å™¨ */
        .real-container {
            width: 100%;
            height: 100vh;
            padding: 8px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* é¡¶éƒ¨çŠ¶æ€æ  */
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 8px;
            margin-bottom: 6px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .real-mode-indicator {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        
        /* æ§åˆ¶æŒ‰é’®è¡Œ */
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            margin-bottom: 8px;
        }
        
        .action-btn {
            background: rgba(33, 150, 243, 0.9);
            color: white;
            border: none;
            padding: 8px 3px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: bold;
            cursor: pointer;
            min-height: 32px;
            transition: all 0.2s;
        }
        
        .action-btn:active {
            transform: scale(0.95);
        }
        
        .action-btn.vpn { background: rgba(255, 152, 0, 0.9); }
        .action-btn.real { background: rgba(76, 175, 80, 0.9); }
        .action-btn.test { background: rgba(156, 39, 176, 0.9); }
        .action-btn.dash { background: rgba(0, 150, 136, 0.9); }
        
        /* ä¸‰ä¸ªå¹¿å‘Šä½ç´§å‡‘å¸ƒå±€ */
        .ad-slots-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            margin-bottom: 8px;
            flex: 1;
            min-height: 0;
        }
        
        .ad-slot-card {
            background: rgba(255,255,255,0.07);
            border-radius: 10px;
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.15);
            display: flex;
            flex-direction: column;
            min-height: 140px;
        }
        
        .slot-number {
            width: 22px;
            height: 22px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .slot-status {
            flex: 1;
            background: rgba(0,0,0,0.4);
            border-radius: 6px;
            padding: 8px;
            margin: 5px 0;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-height: 35px;
            word-break: break-word;
        }
        
        .slot-earnings {
            font-size: 10px;
            color: #ccc;
            text-align: center;
            margin: 3px 0;
        }
        
        .earnings-real {
            color: #4CAF50;
            font-weight: bold;
            font-size: 13px;
        }
        
        .slot-action-btn {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            padding: 7px 0;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 5px;
            min-height: 30px;
        }
        
        .slot-action-btn:disabled {
            background: #555;
            cursor: not-allowed;
        }
        
        /* å®æ—¶ç»Ÿè®¡ */
        .live-stats {
            background: rgba(0,0,0,0.25);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 8px;
        }
        
        .stats-header {
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            color: #4CAF50;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
        }
        
        .stat-box {
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
            padding: 6px;
            text-align: center;
        }
        
        .stat-label {
            font-size: 9px;
            color: #aaa;
            margin-bottom: 2px;
        }
        
        .stat-value {
            font-size: 12px;
            font-weight: bold;
        }
        
        /* æ”¶ç›Šè®°å½• */
        .earnings-log {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 8px;
            flex: 1;
            min-height: 0;
            overflow-y: auto;
            max-height: 150px;
        }
        
        .log-header {
            font-size: 11px;
            font-weight: bold;
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
            color: #FF9800;
        }
        
        .log-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            font-size: 10px;
        }
        
        /* æ¨ªå±ä¼˜åŒ– */
        @media (orientation: landscape) {
            .ad-slots-grid {
                min-height: 120px;
            }
            
            .ad-slot-card {
                min-height: 120px;
            }
            
            .earnings-log {
                max-height: 100px;
            }
        }
        
        /* è¶…å°å±å¹• */
        @media (max-width: 320px) {
            .action-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* åŠ¨ç”» */
        @keyframes coinSpin {
            0% { transform: rotateY(0); }
            100% { transform: rotateY(360deg); }
        }
        
        .coin-spin {
            animation: coinSpin 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="real-container">
        <!-- é¡¶éƒ¨çŠ¶æ€ -->
        <div class="status-bar">
            <div style="font-size: 12px; font-weight: bold;">ğŸ’° çœŸå®æ”¶ç›Šæ¨¡å¼</div>
            <div class="real-mode-indicator" id="mode-indicator">æ£€æµ‹ä¸­...</div>
        </div>
        
        <!-- æ§åˆ¶æŒ‰é’® -->
        <div class="action-buttons">
            <button class="action-btn vpn" onclick="checkVPN()">
                <span>ğŸ”—</span><br>VPNæ£€æµ‹
            </button>
            <button class="action-btn real" onclick="initRealEarnings()" id="real-btn">
                <span>ğŸ’°</span><br>çœŸå®æ¨¡å¼
            </button>
            <button class="action-btn test" onclick="testAllAds()">
                <span>ğŸš€</span><br>ä¸€é”®æµ‹è¯•
            </button>
            <button class="action-btn dash" onclick="openDashboard()">
                <span>ğŸ“Š</span><br>æ”¶ç›Šåå°
            </button>
        </div>
        
        <!-- ä¸‰ä¸ªå¹¿å‘Šä½ -->
        <div class="ad-slots-grid">
            <!-- å¹¿å‘Šä½ 1 -->
            <div class="ad-slot-card">
                <div class="slot-number">1</div>
                <div class="slot-status" id="status1">âœ… å‡†å¤‡å°±ç»ª</div>
                <div class="slot-earnings">
                    æ”¶ç›Š: <span class="earnings-real" id="earnings1">$0.00</span>
                </div>
                <button class="slot-action-btn" onclick="showRealAd(1)" id="btn1">
                    ğŸ¬ è§‚çœ‹çœŸå®å¹¿å‘Š
                </button>
            </div>
            
            <!-- å¹¿å‘Šä½ 2 -->
            <div class="ad-slot-card">
                <div class="slot-number">2</div>
                <div class="slot-status" id="status2">âœ… å‡†å¤‡å°±ç»ª</div>
                <div class="slot-earnings">
                    æ”¶ç›Š: <span class="earnings-real" id="earnings2">$0.00</span>
                </div>
                <button class="slot-action-btn" onclick="showRealAd(2)" id="btn2">
                    ğŸ¬ è§‚çœ‹çœŸå®å¹¿å‘Š
                </button>
            </div>
            
            <!-- å¹¿å‘Šä½ 3 -->
            <div class="ad-slot-card">
                <div class="slot-number">3</div>
                <div class="slot-status" id="status3">âœ… å‡†å¤‡å°±ç»ª</div>
                <div class="slot-earnings">
                    æ”¶ç›Š: <span class="earnings-real" id="earnings3">$0.00</span>
                </div>
                <button class="slot-action-btn" onclick="showRealAd(3)" id="btn3">
                    ğŸ¬ è§‚çœ‹çœŸå®å¹¿å‘Š
                </button>
            </div>
        </div>
        
        <!-- å®æ—¶ç»Ÿè®¡ -->
        <div class="live-stats">
            <div class="stats-header">
                <span>ğŸ“ˆ å®æ—¶ç»Ÿè®¡</span>
                <span id="update-time">åˆšåˆšæ›´æ–°</span>
            </div>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-label">ä»Šæ—¥æ”¶ç›Š</div>
                    <div class="stat-value" id="todayEarnings">$0.00</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">ç´¯è®¡æ”¶ç›Š</div>
                    <div class="stat-value" id="totalEarnings">$0.00</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">å¹¿å‘Šå±•ç¤º</div>
                    <div class="stat-value" id="impressions">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">ç‚¹å‡»ç‡</div>
                    <div class="stat-value" id="clickRate">0%</div>
                </div>
            </div>
        </div>
        
        <!-- æ”¶ç›Šè®°å½• -->
        <div class="earnings-log">
            <div class="log-header">
                <span>ğŸ“‹ æ”¶ç›Šè®°å½•</span>
                <span id="record-count">0 æ¡</span>
            </div>
            <div id="earnings-log-content">
                <div style="text-align:center;padding:10px;color:#666;font-size:11px;">
                    æš‚æ— æ”¶ç›Šè®°å½•
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== çœŸå®æ”¶ç›Šé…ç½® ==========
        const REAL_CONFIG = {
            // UnityçœŸå®é…ç½®
            gameId: '6028834',
            adUnits: ['youmeng1', 'youmeng2', 'youmeng3'],
            
            // çœŸå®æ”¶ç›Šæ¨¡å¼
            testMode: false, // ğŸš¨ å¿…é¡»æ˜¯ falseï¼
            
            // æ¸¸æˆè®¾ç½®
            adCooldown: 30,
            baseEarnings: 0.35,
            
            // ä»£ç†è®¾ç½®
            useProxy: true,
            proxyUrls: [
                'https://cdn.unityads.unity3d.com/unity-ads-sdk.js',
                'https://unity3d.com/ads/web/sdk/unity-ads-sdk.js'
            ]
        };
        
        // ========== çœŸå®æ”¶ç›Šæ•°æ® ==========
        let realGameData = {
            // åŸºç¡€ç»Ÿè®¡
            impressions: 0,
            clicks: 0,
            todayEarnings: 0,
            totalEarnings: 0,
            realEarnings: 0, // çœŸå®æ”¶ç›Šéƒ¨åˆ†
            
            // å¹¿å‘Šä½æ•°æ®
            adCooldowns: [0, 0, 0],
            adEarnings: [0, 0, 0],
            adRealCounts: [0, 0, 0], // çœŸå®å¹¿å‘Šæ¬¡æ•°
            
            // æ”¶ç›Šè®°å½•
            earningsLog: [],
            
            // UnityçŠ¶æ€
            unityReady: false,
            unityInitialized: false,
            
            // å…ƒæ•°æ®
            todayDate: new Date().toLocaleDateString('zh-CN'),
            startTime: Date.now()
        };
        
        // ========== çœŸå®æ”¶ç›Šç³»ç»Ÿ ==========
        class RealEarningsSystem {
            constructor() {
                console.log('ğŸ’° çœŸå®æ”¶ç›Šç³»ç»Ÿå¯åŠ¨');
                this.sdkLoaded = false;
                this.init();
            }
            
            async init() {
                // æ›´æ–°çŠ¶æ€
                this.updateStatus('æ­£åœ¨åŠ è½½çœŸå®æ”¶ç›Šç³»ç»Ÿ...');
                
                // 1. å°è¯•åŠ è½½Unity SDK
                await this.loadUnitySDK();
                
                // 2. åˆå§‹åŒ–Unity
                if (this.sdkLoaded) {
                    await this.initializeUnity();
                }
                
                // 3. åŠ è½½æœ¬åœ°æ•°æ®
                this.loadLocalData();
                
                console.log('âœ… çœŸå®æ”¶ç›Šç³»ç»Ÿå°±ç»ª');
            }
            
            async loadUnitySDK() {
                console.log('ğŸ“¦ åŠ è½½Unity SDK...');
                
                return new Promise((resolve) => {
                    // ç›‘å¬é¢„åŠ è½½çš„SDK
                    window.addEventListener('unitysdk:loaded', (event) => {
                        console.log('âœ… Unity SDKé€šè¿‡ä»£ç†åŠ è½½æˆåŠŸ');
                        this.sdkLoaded = true;
                        window.unityads = event.detail.unityads;
                        resolve(true);
                    });
                    
                    // å¦‚æœ3ç§’å†…æ²¡æ”¶åˆ°äº‹ä»¶ï¼Œå°è¯•ç›´æ¥åŠ è½½
                    setTimeout(() => {
                        if (typeof unityads !== 'undefined') {
                            console.log('âœ… Unity SDKå·²å­˜åœ¨');
                            this.sdkLoaded = true;
                            resolve(true);
                        } else {
                            console.log('â° ä»£ç†åŠ è½½è¶…æ—¶ï¼Œå°è¯•ç›´æ¥åŠ è½½');
                            this.loadSDKDirectly().then(resolve);
                        }
                    }, 3000);
                });
            }
            
            async loadSDKDirectly() {
                return new Promise((resolve) => {
                    const script = document.createElement('script');
                    script.src = REAL_CONFIG.proxyUrls[0];
                    script.crossOrigin = 'anonymous';
                    
                    let timeout = setTimeout(() => {
                        console.log('âŒ SDKåŠ è½½è¶…æ—¶');
                        resolve(false);
                    }, 10000);
                    
                    script.onload = () => {
                        clearTimeout(timeout);
                        if (typeof unityads !== 'undefined') {
                            console.log('âœ… SDKç›´æ¥åŠ è½½æˆåŠŸ');
                            this.sdkLoaded = true;
                            resolve(true);
                        } else {
                            console.log('âŒ unityadså¯¹è±¡æœªå®šä¹‰');
                            resolve(false);
                        }
                    };
                    
                    script.onerror = () => {
                        clearTimeout(timeout);
                        console.log('âŒ SDKç›´æ¥åŠ è½½å¤±è´¥');
                        resolve(false);
                    };
                    
                    document.head.appendChild(script);
                });
            }
            
            async initializeUnity() {
                console.log('ğŸ”— åˆå§‹åŒ–UnityçœŸå®æ”¶ç›Š...');
                this.updateStatus('æ­£åœ¨åˆå§‹åŒ–Unity...');
                
                return new Promise((resolve) => {
                    if (typeof unityads === 'undefined') {
                        console.log('âŒ unityadsæœªå®šä¹‰');
                        resolve(false);
                        return;
                    }
                    
                    unityads.init(REAL_CONFIG.gameId, {
                        testMode: REAL_CONFIG.testMode,
                        onInitialized: () => {
                            console.log('ğŸ‰ UnityçœŸå®æ”¶ç›Šæ¨¡å¼åˆå§‹åŒ–æˆåŠŸï¼');
                            console.log('ğŸ’° æµ‹è¯•æ¨¡å¼:', REAL_CONFIG.testMode ? 'æ˜¯(æµ‹è¯•)' : 'å¦(çœŸå®æ”¶ç›Š)');
                            
                            realGameData.unityReady = true;
                            realGameData.unityInitialized = true;
                            
                            this.updateStatus('âœ… çœŸå®æ”¶ç›Šå°±ç»ª');
                            this.updateModeDisplay('ğŸ’° çœŸå®æ”¶ç›Š');
                            
                            // æ˜¾ç¤ºæˆåŠŸé€šçŸ¥
                            this.showNotification('ğŸ‰ UnityçœŸå®æ”¶ç›Šæ¨¡å¼å·²å¯ç”¨ï¼', '#4CAF50');
                            
                            resolve(true);
                        },
                        onFailed: (error) => {
                            console.error('âŒ Unityåˆå§‹åŒ–å¤±è´¥:', error);
                            this.updateStatus('âŒ Unityåˆå§‹åŒ–å¤±è´¥');
                            this.updateModeDisplay('âŒ è¿æ¥å¤±è´¥');
                            
                            // æ˜¾ç¤ºé”™è¯¯é€šçŸ¥
                            this.showNotification('âŒ Unityåˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ', '#f44336');
                            
                            resolve(false);
                        }
                    });
                    
                    // è¶…æ—¶ä¿æŠ¤
                    setTimeout(() => {
                        console.log('â° Unityåˆå§‹åŒ–è¶…æ—¶');
                        resolve(false);
                    }, 15000);
                });
            }
            
            async showRealAd(adSlotId) {
                if (!realGameData.unityInitialized) {
                    this.showNotification('Unityæœªåˆå§‹åŒ–ï¼Œè¯·ç¨åé‡è¯•', '#FF9800');
                    return { success: false, message: 'Unityæœªåˆå§‹åŒ–' };
                }
                
                const adId = adSlotId - 1;
                
                // æ£€æŸ¥å†·å´
                if (realGameData.adCooldowns[adId] > 0) {
                    return { 
                        success: false, 
                        message: `å†·å´ä¸­ï¼Œè¯·ç­‰å¾… ${realGameData.adCooldowns[adId]} ç§’` 
                    };
                }
                
                console.log(`ğŸ¬ å±•ç¤ºçœŸå®Unityå¹¿å‘Š ${adSlotId}`);
                
                try {
                    const adUnitId = REAL_CONFIG.adUnits[adSlotId - 1];
                    
                    const result = await new Promise((resolve) => {
                        unityads.show(adUnitId, {
                            onClosed: (adResult) => {
                                if (adResult && adResult.completed) {
                                    console.log('âœ… ç”¨æˆ·å®Œæˆè§‚çœ‹çœŸå®å¹¿å‘Š');
                                    console.log('ğŸ’° æ”¶ç›Šå·²è®¡å…¥Unityåå°è´¦æˆ·');
                                    
                                    // è®°å½•å¹¿å‘Šå®Œæˆ
                                    this.recordRealAdComplete(adSlotId);
                                    
                                    resolve({
                                        success: true,
                                        isRealAd: true,
                                        earnings: REAL_CONFIG.baseEarnings,
                                        message: 'çœŸå®å¹¿å‘Šå®Œæˆï¼æ”¶ç›Šè®¡å…¥Unityåå°'
                                    });
                                } else {
                                    resolve({
                                        success: false,
                                        message: 'å¹¿å‘Šæœªå®Œæˆè§‚çœ‹'
                                    });
                                }
                            },
                            onFailed: (error) => {
                                console.error('âŒ çœŸå®å¹¿å‘Šå¤±è´¥:', error);
                                resolve({
                                    success: false,
                                    message: 'å¹¿å‘ŠåŠ è½½å¤±è´¥: ' + error
                                });
                            }
                        });
                    });
                    
                    return result;
                    
                } catch (error) {
                    console.error('âŒ å¹¿å‘Šå¼‚å¸¸:', error);
                    return {
                        success: false,
                        message: 'å¹¿å‘Šç³»ç»Ÿå¼‚å¸¸'
                    };
                }
            }
            
            recordRealAdComplete(adSlotId) {
                const adId = adSlotId - 1;
                const earnings = REAL_CONFIG.baseEarnings;
                
                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                realGameData.impressions++;
                realGameData.clicks++;
                realGameData.todayEarnings += earnings;
                realGameData.totalEarnings += earnings;
                realGameData.realEarnings += earnings;
                realGameData.adEarnings[adId] += earnings;
                realGameData.adRealCounts[adId]++;
                realGameData.adCooldowns[adId] = REAL_CONFIG.adCooldown;
                
                // æ·»åŠ æ”¶ç›Šè®°å½•
                this.addEarningRecord(adSlotId, earnings, 'çœŸå®');
                
                // æ›´æ–°UI
                updateRealStats();
                updateCooldownDisplay();
                updateEarningsLog();
                
                // æ’­æ”¾æ”¶ç›ŠåŠ¨ç”»
                this.playCoinAnimation(adSlotId);
                
                // æ›´æ–°çŠ¶æ€
                this.updateAdStatus(adSlotId, 'çœŸå®å®Œæˆ');
                
                // æ˜¾ç¤ºé€šçŸ¥
                this.showNotification(
                    `ğŸ‰ å¹¿å‘Šä½ ${adSlotId} å®Œæˆï¼\nğŸ’° +$${earnings.toFixed(2)} æ”¶ç›Šè®¡å…¥Unityåå°`,
                    '#4CAF50'
                );
                
                // æ›´æ–°Unityåå°æ—¶é—´
                document.getElementById('update-time').textContent = 'åˆšåˆšæ›´æ–°';
            }
            
            addEarningRecord(adSlotId, earnings, type) {
                const now = new Date();
                const timeStr = now.toLocaleTimeString('zh-CN', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: false
                });
                
                const record = {
                    id: Date.now(),
                    time: timeStr,
                    adSlot: adSlotId,
                    earnings: earnings.toFixed(2),
                    type: type,
                    status: 'å®Œæˆ'
                };
                
                realGameData.earningsLog.unshift(record);
                
                // é™åˆ¶è®°å½•æ•°é‡
                if (realGameData.earningsLog.length > 20) {
                    realGameData.earningsLog = realGameData.earningsLog.slice(0, 20);
                }
            }
            
            updateStatus(message) {
                console.log('ğŸ“± çŠ¶æ€:', message);
                const indicator = document.getElementById('mode-indicator');
                if (indicator) {
                    indicator.textContent = message;
                }
            }
            
            updateModeDisplay(mode) {
                const indicator = document.getElementById('mode-indicator');
                if (indicator) {
                    if (mode === 'ğŸ’° çœŸå®æ”¶ç›Š') {
                        indicator.textContent = mode;
                        indicator.style.background = 'linear-gradient(135deg, #4CAF50, #2E7D32)';
                        indicator.style.animation = 'pulse 2s infinite';
                    } else if (mode === 'âŒ è¿æ¥å¤±è´¥') {
                        indicator.textContent = mode;
                        indicator.style.background = '#f44336';
                        indicator.style.animation = 'none';
                    } else {
                        indicator.textContent = mode;
                        indicator.style.background = '#FF9800';
                        indicator.style.animation = 'none';
                    }
                }
            }
            
            updateAdStatus(adSlotId, message) {
                const statusEl = document.getElementById(`status${adSlotId}`);
                const earningsEl = document.getElementById(`earnings${adSlotId}`);
                
                if (statusEl) {
                    statusEl.textContent = `âœ… ${message}`;
                }
                
                if (earningsEl) {
                    earningsEl.textContent = '$' + realGameData.adEarnings[adSlotId - 1].toFixed(2);
                    earningsEl.classList.add('coin-spin');
                    setTimeout(() => earningsEl.classList.remove('coin-spin'), 500);
                }
            }
            
            playCoinAnimation(adSlotId) {
                const earningElement = document.getElementById(`earnings${adSlotId}`);
                if (earningElement) {
                    earningElement.classList.remove('coin-spin');
                    void earningElement.offsetWidth;
                    earningElement.classList.add('coin-spin');
                }
            }
            
            showNotification(message, color) {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 50px;
                    right: 10px;
                    background: ${color};
                    color: white;
                    padding: 10px 15px;
                    border-radius: 10px;
                    z-index: 10000;
                    font-size: 12px;
                    animation: slideIn 0.3s ease;
                    box-shadow: 0 5px 20px rgba(0,0,0,0.3);
                    max-width: 250px;
                    border-left: 4px solid rgba(255,255,255,0.3);
                `;
                
                notification.innerHTML = message;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 4000);
                
                // æ·»åŠ åŠ¨ç”»æ ·å¼
                if (!document.getElementById('notif-anim')) {
                    const style = document.createElement('style');
                    style.id = 'notif-anim';
                    style.textContent = `
                        @keyframes slideIn {
                            from { transform: translateX(100%); opacity: 0; }
                            to { transform: translateX(0); opacity: 1; }
                        }
                        @keyframes slideOut {
                            from { transform: translateX(0); opacity: 1; }
                            to { transform: translateX(100%); opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }
            
            loadLocalData() {
                try {
                    const saved = localStorage.getItem('realEarningsData');
                    if (saved) {
                        const parsed = JSON.parse(saved);
                        const today = new Date().toLocaleDateString('zh-CN');
                        
                        // æ£€æŸ¥æ˜¯å¦æ˜¯ä»Šå¤©çš„æ•°æ®
                        if (parsed.todayDate !== today) {
                            parsed.todayEarnings = 0;
                            parsed.todayDate = today;
                            parsed.adCooldowns = [0, 0, 0];
                            parsed.earningsLog = [];
                        }
                        
                        realGameData = {
                            ...realGameData,
                            ...parsed,
                            adCooldowns: parsed.adCooldowns || [0, 0, 0],
                            adEarnings: parsed.adEarnings || [0, 0, 0],
                            adRealCounts: parsed.adRealCounts || [0, 0, 0],
                            earningsLog: parsed.earningsLog || []
                        };
                        
                        updateRealStats();
                        updateEarningsLog();
                        updateCooldownDisplay();
                    }
                } catch (error) {
                    console.log('åŠ è½½æœ¬åœ°æ•°æ®å¤±è´¥:', error);
                }
            }
            
            saveLocalData() {
                try {
                    localStorage.setItem('realEarningsData', JSON.stringify(realGameData));
                } catch (error) {
                    console.log('ä¿å­˜æ•°æ®å¤±è´¥:', error);
                }
            }
        }
        
        // ========== åˆå§‹åŒ–çœŸå®æ”¶ç›Šç³»ç»Ÿ ==========
        const realSystem = new RealEarningsSystem();
        
        // ========== å…¨å±€å‡½æ•° ==========
        // æ£€æŸ¥VPNè¿æ¥
        async function checkVPN() {
            console.log('ğŸ” æ£€æŸ¥VPNè¿æ¥...');
            
            const testUrls = [
                'https://www.google.com',
                'https://cdn.unityads.unity3d.com'
            ];
            
            let results = [];
            
            for (const url of testUrls) {
                try {
                    const start = Date.now();
                    await fetch(url, { method: 'HEAD', mode: 'no-cors' });
                    const latency = Date.now() - start;
                    results.push({ url, success: true, latency });
                } catch (error) {
                    results.push({ url, success: false, error: error.message });
                }
            }
            
            const googleOk = results[0].success;
            const unityOk = results[1].success;
            
            let message = 'ğŸ“Š VPNè¿æ¥æ£€æµ‹ç»“æœï¼š\n\n';
            
            if (googleOk && unityOk) {
                message += 'âœ… VPNè¿æ¥æ­£å¸¸\n';
                message += `âœ… UnityæœåŠ¡å¯è®¿é—® (å»¶è¿Ÿ: ${results[1].latency}ms)\n\n`;
                message += 'ğŸ‰ å¯ä»¥æ­£å¸¸ä½¿ç”¨çœŸå®æ”¶ç›Šæ¨¡å¼ï¼';
            } else if (googleOk && !unityOk) {
                message += 'âœ… VPNåŸºæœ¬è¿æ¥æ­£å¸¸\n';
                message += 'âŒ UnityæœåŠ¡è¢«é¢å¤–é™åˆ¶\n\n';
                message += 'ğŸ’¡ å»ºè®®ï¼š\n';
                message += '1. æ›´æ¢VPNèŠ‚ç‚¹\n';
                message += '2. ä½¿ç”¨ç¾å›½è¥¿æµ·å²¸èŠ‚ç‚¹\n';
                message += '3. å°è¯•WireGuardåè®®';
            } else {
                message += 'âŒ VPNæœªè¿æ¥æˆ–å¤±æ•ˆ\n\n';
                message += 'ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼š\n';
                message += '1. ç¡®è®¤VPNå·²è¿æ¥\n';
                message += '2. æ›´æ¢VPNèŠ‚ç‚¹\n';
                message += '3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜';
            }
            
            alert(message);
        }
        
        // åˆå§‹åŒ–çœŸå®æ”¶ç›Š
        async function initRealEarnings() {
            if (realGameData.unityInitialized) {
                alert('ğŸ’° å·²ç»æ˜¯çœŸå®æ”¶ç›Šæ¨¡å¼ï¼\n\nğŸ“Š ç»Ÿè®¡ä¿¡æ¯ï¼š\n' +
                      `ä»Šæ—¥æ”¶ç›Š: $${realGameData.todayEarnings.toFixed(2)}\n` +
                      `ç´¯è®¡æ”¶ç›Š: $${realGameData.totalEarnings.toFixed(2)}\n` +
                      `çœŸå®å¹¿å‘Šæ¬¡æ•°: ${realGameData.adRealCounts.reduce((a, b) => a + b, 0)}æ¬¡`);
                return;
            }
            
            // æ£€æŸ¥ç½‘ç»œ
            const networkOk = await testNetwork();
            
            if (!networkOk) {
                alert('âŒ ç½‘ç»œè¿æ¥å¤±è´¥\n\nè¯·ç¡®è®¤ï¼š\n1. VPNå·²è¿æ¥\n2. ä½¿ç”¨æµ·å¤–èŠ‚ç‚¹\n3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜\n\nç„¶åé‡è¯•ï¼');
                return;
            }
            
            // åŠ è½½Unity SDK
            alert('ğŸ”„ æ­£åœ¨åˆå§‹åŒ–çœŸå®æ”¶ç›Šæ¨¡å¼...\n\nè¯·ç¨å€™ï¼Œè¿™å¯èƒ½éœ€è¦å‡ ç§’é’Ÿ');
            
            const realBtn = document.getElementById('real-btn');
            realBtn.disabled = true;
            realBtn.innerHTML = '<span>â³</span><br>åˆå§‹åŒ–ä¸­...';
            
            // ç­‰å¾…ç³»ç»Ÿåˆå§‹åŒ–
            setTimeout(() => {
                if (realGameData.unityInitialized) {
                    alert('ğŸ‰ çœŸå®æ”¶ç›Šæ¨¡å¼åˆå§‹åŒ–æˆåŠŸï¼\n\nğŸ’° ç°åœ¨å¼€å§‹äº§ç”ŸçœŸå®ç¾å…ƒæ”¶ç›Šï¼\nğŸ“Š æ”¶ç›Šè®¡å…¥Unityåå°è´¦æˆ·');
                } else {
                    alert('âŒ åˆå§‹åŒ–å¤±è´¥\n\nå¯èƒ½åŸå› ï¼š\n1. VPNè¿æ¥ä¸ç¨³å®š\n2. UnityæœåŠ¡å™¨é—®é¢˜\n3. ç½‘ç»œé™åˆ¶\n\nè¯·ç¨åé‡è¯•');
                }
                
                realBtn.disabled = false;
                realBtn.innerHTML = '<span>ğŸ’°</span><br>çœŸå®æ¨¡å¼';
            }, 5000);
        }
        
        async function testNetwork() {
            try {
                await fetch('https://www.google.com', { 
                    method: 'HEAD',
                    mode: 'no-cors'
                });
                return true;
            } catch (error) {
                return false;
            }
        }
        
        // æ˜¾ç¤ºçœŸå®å¹¿å‘Š
        async function showRealAd(adSlotId) {
            const btn = document.getElementById(`btn${adSlotId}`);
            const statusEl = document.getElementById(`status${adSlotId}`);
            
            // ä¿å­˜åŸå§‹çŠ¶æ€
            const originalText = btn.innerHTML;
            const originalStatus = statusEl.textContent;
            
            btn.disabled = true;
            btn.innerHTML = 'â³ åŠ è½½ä¸­...';
            statusEl.textContent = 'â³ å‡†å¤‡çœŸå®å¹¿å‘Š...';
            
            try {
                const result = await realSystem.showRealAd(adSlotId);
                
                if (result.success) {
                    if (result.isRealAd) {
                        statusEl.textContent = 'âœ… çœŸå®å¹¿å‘Šå®Œæˆï¼';
                    }
                } else {
                    statusEl.textContent = `âš ï¸ ${result.message}`;
                }
            } catch (error) {
                console.error('å¹¿å‘Šé”™è¯¯:', error);
                statusEl.textContent = 'âŒ å¹¿å‘Šå¤±è´¥';
            }
            
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            setTimeout(() => {
                btn.disabled = false;
                btn.innerHTML = originalText;
            }, 1000);
        }
        
        // æ›´æ–°å†·å´æ˜¾ç¤º
        function updateCooldownDisplay() {
            for (let i = 0; i < 3; i++) {
                const statusEl = document.getElementById(`status${i + 1}`);
                const btn = document.getElementById(`btn${i + 1}`);
                
                const cd = realGameData.adCooldowns[i];
                if (cd > 0) {
                    statusEl.textContent = `â³ ${cd}ç§’`;
                    btn.disabled = true;
                    btn.innerHTML = 'å†·å´ä¸­';
                } else {
                    statusEl.textContent = 'âœ… å‡†å¤‡å°±ç»ª';
                    btn.disabled = false;
                    btn.innerHTML = 'ğŸ¬ è§‚çœ‹çœŸå®å¹¿å‘Š';
                }
            }
        }
        
        // æ›´æ–°ç»Ÿè®¡
        function updateRealStats() {
            document.getElementById('impressions').textContent = realGameData.impressions;
            document.getElementById('todayEarnings').textContent = '$' + realGameData.todayEarnings.toFixed(2);
            document.getElementById('totalEarnings').textContent = '$' + realGameData.totalEarnings.toFixed(2);
            
            const clickRate = realGameData.impressions > 0 ? 
                ((realGameData.clicks / realGameData.impressions) * 100).toFixed(1) : 0;
            document.getElementById('clickRate').textContent = clickRate + '%';
            
            for (let i = 0; i < 3; i++) {
                const el = document.getElementById(`earnings${i + 1}`);
                if (el) el.textContent = '$' + realGameData.adEarnings[i].toFixed(2);
            }
            
            // æ›´æ–°è®°å½•æ•°é‡
            document.getElementById('record-count').textContent = `${realGameData.earningsLog.length} æ¡`;
            
            // ä¿å­˜æ•°æ®
            realSystem.saveLocalData();
        }
        
        // æ›´æ–°æ”¶ç›Šè®°å½•
        function updateEarningsLog() {
            const container = document.getElementById('earnings-log-content');
            if (!container) return;
            
            if (realGameData.earningsLog.length === 0) {
                container.innerHTML = `
                    <div style="text-align:center;padding:10px;color:#666;font-size:11px;">
                        æš‚æ— æ”¶ç›Šè®°å½•
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            
            realGameData.earningsLog.forEach(record => {
                const item = document.createElement('div');
                item.className = 'log-item';
                item.innerHTML = `
                    <span>${record.time}</span>
                    <span>å¹¿å‘Š${record.adSlot}</span>
                    <span style="color: ${record.type === 'çœŸå®' ? '#4CAF50' : '#FF9800'}; font-weight: bold;">
                        $${record.earnings}
                    </span>
                `;
                container.appendChild(item);
            });
        }
        
        // æµ‹è¯•æ‰€æœ‰å¹¿å‘Š
        function testAllAds() {
            for (let i = 1; i <= 3; i++) {
                if (realGameData.adCooldowns[i - 1] === 0) {
                    setTimeout(() => {
                        const btn = document.getElementById(`btn${i}`);
                        if (btn && !btn.disabled) {
                            showRealAd(i);
                        }
                    }, i * 1000);
                }
            }
        }
        
        // æ‰“å¼€Unityåå°
        function openDashboard() {
            window.open('https://dashboard.unity3d.com/', '_blank');
        }
        
        // å†·å´è®¡æ—¶å™¨
        setInterval(() => {
            if (realGameData.adCooldowns && Array.isArray(realGameData.adCooldowns)) {
                realGameData.adCooldowns = realGameData.adCooldowns.map(cd => 
                    cd > 0 ? cd - 1 : 0
                );
                updateCooldownDisplay();
            }
        }, 1000);
        
        // è‡ªåŠ¨ä¿å­˜è®¡æ—¶å™¨
        setInterval(() => {
            realSystem.saveLocalData();
        }, 30000);
        
        // é¡µé¢åŠ è½½å®Œæˆ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ’° çœŸå®æ”¶ç›Šæ¸¸æˆåŠ è½½å®Œæˆ');
            console.log('ğŸ¯ ç›®æ ‡ï¼šçœŸå®ç¾å…ƒæ”¶ç›Š');
            console.log('ğŸ”§ é…ç½®ï¼š', REAL_CONFIG);
            
            // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
            document.getElementById('todayDate').textContent = realGameData.todayDate;
            
            // ç§»åŠ¨ç«¯ä¼˜åŒ–
            if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                document.body.style.fontSize = '16px';
            }
            
            console.log('âœ… ç³»ç»Ÿå°±ç»ªï¼Œç­‰å¾…Unityåˆå§‹åŒ–...');
        });
        
        // è‡ªåŠ¨ä¿å­˜
        window.addEventListener('beforeunload', () => {
            realSystem.saveLocalData();
        });
    </script>
</body>
</html>
